{"version":3,"sources":["tester/strategies/test02.ts","tester/interfaces.ts"],"names":["debug","Debug","enter","candles","idx","trade","price","side","i","NONE","date","result","prev1Candle","prev2Candle","prev3Candle","open","close","SELL","BUY","exit","openedTrade","curPrice","diff","high","low","STOP_LOSS","TAKE_PROFIT","ESide"],"mappings":"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","file":"static/js/6.e675b25e.chunk.js","sourcesContent":["//import moment from 'moment';\r\nimport * as i from './../interfaces';\r\n\r\nimport Debug from 'debug'\r\nconst debug = Debug('test02')\r\n\r\nconst TAKE_PROFIT = 2;\r\nconst STOP_LOSS = -3;\r\n\r\nlet enter = function (candles: Array<i.ICandle>, idx: number): i.IStrategyResult {\r\n\r\n  debug('Handling candle: %O', candles[idx]);\r\n  let trade: i.ITrade = { price: 0, side: i.ESide.NONE, date: '' };\r\n  let result: boolean = false;\r\n  if (idx > 2) {\r\n    const prev1Candle = candles[idx - 1];\r\n    const prev2Candle = candles[idx - 2];\r\n    const prev3Candle = candles[idx - 3];\r\n    if (prev1Candle.open < prev1Candle.close && prev2Candle.open < prev2Candle.close && prev3Candle.open < prev3Candle.close) {\r\n      // price is rising fast, expect fall\r\n      trade.price = candles[idx].open;\r\n      trade.date = candles[idx].date;\r\n      trade.side = i.ESide.SELL;\r\n      result = true;\r\n    }\r\n    if (prev1Candle.open > prev1Candle.close && prev2Candle.open > prev2Candle.close && prev3Candle.open > prev3Candle.close) {\r\n      // price is falling fast, expect rise\r\n      trade.price = candles[idx].open;\r\n      trade.date = candles[idx].date;\r\n      trade.side = i.ESide.BUY;\r\n      result = true;\r\n    }\r\n  }\r\n  debug('Enter strategy result: %O', trade);\r\n\r\n  return { result: result, trade: trade };\r\n}\r\n\r\nlet exit = function (candles: Array<i.ICandle>, idx: number, openedTrade: i.ITrade): i.IStrategyResult {\r\n\r\n  let trade: i.ITrade = { price: 0, side: i.ESide.NONE, date: '' };\r\n  let result: boolean = false;\r\n\r\n  let curPrice = candles[idx].open;\r\n  let diff = curPrice - openedTrade.price;\r\n  if (openedTrade.side === i.ESide.BUY) {\r\n    if (diff < STOP_LOSS || diff > TAKE_PROFIT) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].high;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff < STOP_LOSS || diff > TAKE_PROFIT) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].low;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff < STOP_LOSS || diff > TAKE_PROFIT) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].close;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff < STOP_LOSS || diff > TAKE_PROFIT) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n  } else if (openedTrade.side === i.ESide.SELL) {\r\n    if (diff > (STOP_LOSS * -1) || diff < (TAKE_PROFIT * -1)) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].high;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff > (STOP_LOSS * -1) || diff < (TAKE_PROFIT * -1)) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].low;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff > (STOP_LOSS * -1) || diff < (TAKE_PROFIT * -1)) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n\r\n    curPrice = candles[idx].close;\r\n    diff = curPrice - openedTrade.price;\r\n    if (diff > (STOP_LOSS * -1) || diff < (TAKE_PROFIT * -1)) {\r\n      trade.price = curPrice;\r\n      trade.date = candles[idx].date;\r\n      result = true;\r\n      debug('Exit strategy result: %O', trade);\r\n      return { result: result, trade: trade };\r\n    }\r\n  } else {\r\n    // Shouldn't happen\r\n  }\r\n\r\n  return { result: result, trade: trade };\r\n}\r\n\r\nexport {\r\n  enter,\r\n  exit\r\n}","import Big from \"big.js\";\r\n//import moment = require(\"moment\");\r\n\r\nexport interface IExchange {\r\n  name: string,\r\n  fixed_length_name: string,\r\n  api_key: string,\r\n  secret_key: string,\r\n  passphrase?: string,\r\n  ws_timeout_ms: {\r\n    ping: number,\r\n    restart: number\r\n  },\r\n  symbol: string,\r\n  base_asset: string,\r\n  quote_asset: string,\r\n  min_trade_amount: number\r\n}\r\n\r\n/** Tester */\r\nexport enum ESide {\r\n  NONE = 'NONE',\r\n  BUY = 'BUY',\r\n  SELL = 'SELL'\r\n}\r\n\r\nexport interface ITrade {\r\n  price: number,\r\n  side: ESide,\r\n  date: string\r\n}\r\n\r\nexport interface IStrategyResult {\r\n  result: boolean,\r\n  trade: ITrade\r\n}\r\n\r\n/** XAPI */\r\nexport interface ILogin {\r\n  command: string;\r\n  arguments: {\r\n    userId: number;\r\n    password: string;\r\n  }\r\n}\r\n\r\nexport interface IGetAllSymbols {\r\n  command: string;\r\n}\r\n\r\nexport interface IChartLastRequest {\r\n  command: string;\r\n  arguments: {\r\n    info: {\r\n      period: number;\r\n      start: number;\r\n      symbol: string;\r\n    }\r\n  };\r\n}\r\n\r\nexport interface ISymbolRecord {\r\n  \"symbol\": string;\r\n  \"description\": string;\r\n  \"categoryName\": string;\r\n  \"currency\": string;\r\n}\r\n\r\nexport interface IRateInfoRecord {\r\n  close: number;\r\n  ctm: number;\r\n  ctmString: string;\r\n  high: number;\r\n  low: number;\r\n  open: number;\r\n  vol: number;\r\n}\r\n\r\n/** Alphavantage */\r\nexport interface IBestMatch {\r\n  \"1. symbol\": string;\r\n  \"2. name\": string;\r\n  \"3. type\": string;\r\n  \"4. region\": string;\r\n  \"5. marketOpen\": string;\r\n  \"6. marketClose\": string;\r\n  \"7. timezone\": string;\r\n  \"8. currency\": string;\r\n  \"9. matchScore\": string;\r\n}\r\n\r\nexport interface ITimeSeries {\r\n  \"1. open\": number;\r\n  \"2. high\": number;\r\n  \"3. low\": number;\r\n  \"4. close\": number;\r\n  \"5. volume\": number;\r\n}\r\n\r\n/** Common */\r\nexport interface ISymbol {\r\n  symbol: string;\r\n  name: string;\r\n  type: string;\r\n  currency: string;\r\n}\r\n\r\nexport interface ICandle {\r\n  date: any,\r\n  open: number,\r\n  high: number,\r\n  low: number,\r\n  close: number,\r\n  volume: number\r\n}\r\n\r\nexport interface IMyCandles {\r\n  symbol: string,\r\n  period: string,\r\n  isDefault: boolean,\r\n  candles: Array<ICandle>\r\n}"],"sourceRoot":""}